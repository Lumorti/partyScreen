<!DOCTYPE html>
<html>

<style>

	#mainDiv {

		margin: auto;
		width: 90%;
		text-align: center;

	}

	.choiceActive {


		width: 10em;
		height: auto;
		padding: 1em;
		margin-bottom: 1em;
		outline: none;
		font-size: 1em;
		border-radius: 0.5em;
		border: 0.3em solid black;

	}


	.choice {


		width: 10em;
		height: auto;
		padding: 1em;
		padding: 1em;
		margin-bottom: 1em;
		outline: none;
		font-size: 1em;
		border-radius: 0.5em;
		border-width: 0.1em;

	}

	body{width:100%; font-size: 3em;}
	html{width:100%; font-size: 1em;}

</style>

<script type="text/javascript">

	let choiceArray = [];
	let selected = -1;
	let songs = [];

	function init(){

		choiceArray = [];
		choiceArray.push(document.getElementById("choice1"));
		choiceArray.push(document.getElementById("choice2"));
		choiceArray.push(document.getElementById("choice3"));
		choiceArray.push(document.getElementById("choice4"));
		choiceArray.push(document.getElementById("choice5"));

		refreshQ();

		// Refresh every 5 seconds
		//window.setInterval(function(){
		//	refreshQ();
		//}, 5000);

	}

	function refreshQ(){

		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
			if (this.status == 200) {
				data = this.responseText;
				data = data.replace(/'/g, '"');
				data = data.replace(/#x420/g, "'");
				console.log(data);
				songs = JSON.parse(data);
				for (i = 0; i < songs.length; i++){
					choiceArray[i].innerHTML = getText(i);
				}
			}
		};
		xhttp.open("GET", "/refresh", true);
		xhttp.send();

	}

	function getText(num){

		x = songs[num]["title"];
		if (songs[num]["artist"] != "") {x += " (" + songs[num]["artist"] + ")";}
		return x;

	}

	function toggle(num){

		if (selected != -1){
			choiceArray[selected].className = "choice";
		}
		selected = num-1;
		choiceArray[selected].className = "choiceActive";

	}

	function vote(num){

		toSend = num
		var xhttp = new XMLHttpRequest();
		xhttp.open("GET", "/send" + toSend, true);
		xhttp.send();

	}

</script>

<body onload="init()">

<div id="mainDiv">

	<div id="voteDiv">
		<button class="choice" id="choice1" onclick="toggle(1);"></button>
		<button class="choice" id="choice2" onclick="toggle(2);"></button>
		<button class="choice" id="choice3" onclick="toggle(3);"></button>
		<button class="choice" id="choice4" onclick="toggle(4);"></button>
		<button class="choice" id="choice5" onclick="toggle(5);"></button>
	</div>

</div>

</body>
</html>

